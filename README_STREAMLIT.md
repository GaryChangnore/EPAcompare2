# EPA 專案比對工具 - 網頁介面使用說明

## 快速啟動

### 方法 1：使用啟動腳本（推薦）

```bash
./run_app.sh
```

### 方法 2：直接啟動

```bash
streamlit run app.py
```

## 使用步驟

### 1. 啟動應用程式

執行啟動腳本後，瀏覽器會自動開啟（通常是 http://localhost:8501）

### 2. 上傳 Excel 檔案

- 點擊「選擇檔案」按鈕
- 選擇 **2 個或以上** 的 Excel 檔案（`.xlsx` 或 `.xls`）
- 可以一次選擇多個檔案，或分次上傳

### 3. 確認檔案列表

- 檢查上傳的檔案名稱和大小
- 確認檔案順序正確
- 系統會依檔案修改時間自動排序

### 4. 執行比對

- 點擊「🚀 開始比對」按鈕
- 等待處理完成（會顯示進度條）

### 5. 下載結果

- 比對完成後，點擊「📥 下載比對結果 Excel」按鈕
- 下載的檔案會自動命名為：`EPA_比對結果_YYYYMMDD_HHMMSS.xlsx`

## 介面說明

### 左側邊欄

- **使用步驟**：詳細的操作說明
- **注意事項**：重要提醒和限制
- **顏色說明**：標記顏色的意義

### 主畫面

- **檔案上傳區**：拖放或點擊上傳檔案
- **檔案列表**：顯示已上傳的檔案資訊
- **比對按鈕**：執行比對作業
- **下載按鈕**：下載比對結果

## 顏色標記說明

### 🟡 黃色標示
- **意義**：最新時間點與前一個時間點相比，欄位值有差異
- **標記範圍**：
  - 變動的儲存格本身
  - Seq 欄位
  - Snapshot_Date 欄位
  - 專案名稱欄位（Project Name 或 Applicant Name）

### 🔴 紅色標示
- **意義**：不同檔案的欄位結構不一致
- **可能原因**：
  - 欄位數量不同
  - 欄位名稱不同
  - 欄位順序不同
- **處理方式**：檢查資料來源，確保所有檔案結構一致

## 常見問題

### Q: 上傳檔案後沒有反應？
- 確認至少上傳了 2 個檔案
- 檢查檔案格式是否為 `.xlsx` 或 `.xls`
- 重新整理頁面後再試

### Q: 比對時出現錯誤？
- 確認檔案包含 `Project Name` 或 `Applicant Name` 欄位
- 檢查檔案是否損壞或格式不正確
- 查看錯誤訊息中的詳細說明

### Q: 所有專案都標示為紅色？
- 檢查所有檔案的欄位結構是否一致
- 確認欄位名稱、順序、數量都相同
- 可能需要統一檔案格式後重新上傳

### Q: 如何停止應用程式？
- 在終端機按 `Ctrl+C`
- 關閉瀏覽器不會停止服務，需在終端機停止

## 技術說明

- **後端框架**：Streamlit
- **處理引擎**：pandas + openpyxl
- **臨時檔案**：自動清理，不會佔用硬碟空間
- **檔案大小限制**：Streamlit 預設 200MB（可在設定中調整）

## 進階設定

### 修改連接埠

```bash
streamlit run app.py --server.port 8502
```

### 自訂伺服器設定

建立 `.streamlit/config.toml`：

```toml
[server]
maxUploadSize = 500
port = 8501
```

## 疑難排解

### 無法啟動應用程式

1. 確認已安裝所有依賴：
   ```bash
   pip install -r requirements.txt
   ```

2. 檢查 Python 版本（建議 3.8+）：
   ```bash
   python3 --version
   ```

3. 檢查 Streamlit 是否正確安裝：
   ```bash
   streamlit --version
   ```

### 檔案上傳失敗

- 檢查檔案大小是否超過限制
- 確認檔案沒有被其他程式開啟
- 嘗試重新命名檔案後再上傳

### 比對結果異常

- 確認所有檔案來自同一個資料來源
- 檢查專案名稱是否一致（大小寫、空白等）
- 查看終端機的錯誤訊息
